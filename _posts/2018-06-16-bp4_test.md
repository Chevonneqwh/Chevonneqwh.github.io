---
layout: post
title: "BP神经网络手写体识别（四）测试BP神经网络"
date: 2018-06-16
tag: BP神经网络
---



<br>

用上面训练出的BP神经网络，对1w个测试集样本进行分类

<br>



### 1. 测试集分类

- 用以上训练出的网络对测试集进行分类

- 代码如下

  ```matlab
  forecast0 = zeros(10000, 10);
  forecast = zeros(10000, 10);
  for v = 1:10000
      for j = 1:midNum   % midNum = 25   产生25个隐含层输入
          Hin(j) = input_test(v,:) * w1(:,j) + b1(j);  % 隐含层输入  行向量：1行25列   （——10000*25）
          Hout(j) = 1/(1+exp(-Hin(j)));  % 隐含层输出     行向量：1行25列(1*25)
      end
      forecast0(v,:) = Hout * w2 + b2;  % 输出层输出     10000*25 25*10————10000*10
      forecast = 1./(1+exp(-forecast0));
  end
  ```

  

<br>



### 2. 优化网络

- 以最初所实现的神经网络，识别率只能达到85%左右
- 为了提高识别率，对此神经网络作出了以下优化
  - 提高迭代次数，至200次
  - 增加训练集的样本数目，每类300个，共3000个
  - 增加隐含层的节点数目，至100个
- Notes
  - 以上所做的优化操作并不是最优的，但在考虑了运行时间、识别率等综合因素之后，这些参数值是相对来说比较合适的
  - 如果在以上基础上，继续增加迭代次数、训练样本和隐含层的节点数，则识别率会小幅度提高，但每次的运行时间会大幅度增加
  - 上面所给出的代码均是优化后的

<br>